# we will use a Jinja for loop
<html>
	<head>
		<title>Todo App</title>
		<style>
			.hidden {
				display: none;
			}
			</style>
	</head>
	<body>
		<form id="form">
			<input type="text" id="description" name="description" />
			<input type="submit" value="Create" />
		  </form>
			<div id="error" class="hidden"> Something went wrong</div>
		
		<ul id="todos">
			{% for d in data %}
			<li>{{ d.description }}</li>
			{% endfor %}
		</ul>
		<script>
			document.getElementById('form').onsubmit = function(e) {
			//prevents the page refresh using the form its submission from the above code, and modifies the default behaviour
			e.preventDefault();
			//the fetch async request
			fetch('/todos/create', {
				method: 'POST',
				body: JSON.stringify({
					'description': document.getElementById('description').value
				}),
				headers: {
					'Content-Type':'application/json'
			}
		})
		.then(function(response){
			return response.json();
		})
		.then(function(jsonResponse) {
			console.log(jsonResponse);
			const liItem = document.createElement('LI');
			liItem.innerHTML = jsonResponse['description'];
			document.getElementById('todos').appendChild(liItem);
			document.getElementById('error').className = 'hidden';
		})
		.catch(function(){
		//we will remove the className hidden from the element above, so it will be displayed
			document.getElementById('error').className = '';
		})
		}
		</script>
	</body>
</html>